# 单价计算器 Android移动版 - 使用说明

## 概述

单价计算器V4移动版是基于Kivy框架开发的Android应用，功能与桌面版完全一致，专为移动设备优化。

## 界面布局

### 简洁实用的移动端布局

应用采用**上下分区**设计，简洁实用，以功能为主：

#### 上半区（40%）- 信息展示区
所有计算结果以简洁的列表形式展示：
- 原料单价
- 加工单价
- 印刷单价
- 单袋单价（蓝色高亮，核心结果）
- 原料重量
- 总费用

#### 下半区（60%）- 数据输入区
- **控制栏**：原料/加工/印刷复选框 + 重置按钮
- **原料计算模块**：开口、宽度、厚度、参数值、原料价格
- **加工计算模块**：个数、工费参数
- **印刷计算模块**：工费参数、版材类型

### 布局优势

1. **简洁实用**：去除了花哨的装饰，专注于功能
2. **一目了然**：所有计算结果集中在上半区，清晰列表展示
3. **便于输入**：输入区域在下半区，方便单手操作
4. **实时计算**：输入变化时自动更新所有结果

## 功能特性

### 核心功能
- ✅ 原料计算：根据开口、宽度、厚度等参数计算原料单价和重量
- ✅ 加工计算：计算加工单价和加工费（最低100元）
- ✅ 印刷计算：计算印刷单价和印刷费（最低为版材价格）
- ✅ 实时计算：输入变化时自动计算
- ✅ 模板管理：创建、编辑、删除、复制、重命名、设为默认
- ✅ 数据持久化：使用JSON文件保存模板数据

### 移动端优化
- ✅ 上下分区布局：结果在上，输入在下
- ✅ 简洁列表展示：所有结果一目了然
- ✅ 实用风格：去除花哨装饰，专注功能
- ✅ 触摸友好：大按钮、易点击的输入框
- ✅ 数字键盘：自动弹出数字输入
- ✅ 滚动优化：长列表滚动流畅
- ✅ 简约配色：黑白灰为主，蓝色突出核心结果

## 安装方法

### 方法1：直接安装APK
1. 将生成的 `unitpricecalculator-1.0.0-arm64-v8a-debug.apk` 传输到手机
2. 在手机上打开APK文件
3. 允许安装未知来源应用（如果提示）
4. 完成安装

### 方法2：通过USB调试安装
```bash
adb install unitpricecalculator-1.0.0-arm64-v8a-debug.apk
```

### 方法3：使用Kivy Launcher（无需打包）
1. 在手机上安装Kivy Launcher（Google Play）
2. 将项目文件复制到 `/sdcard/kivy/单价计算器/`
3. 打开Kivy Launcher即可运行

## 使用方法

### 1. 查看结果（上半区）
打开应用后，上半区以列表形式显示所有计算结果：
- 原料单价
- 加工单价
- 印刷单价
- 单袋单价（蓝色高亮，最核心的结果）
- 原料重量
- 总费用

### 2. 输入参数（下半区）
滚动到下半区，输入参数：
- **原料计算**：开口、宽度、厚度、参数值、原料价格
- **加工计算**：个数、加工工费参数
- **印刷计算**：印刷工费参数、版材类型

### 3. 模块控制
- 勾选/取消勾选：原料、加工、印刷复选框
- 点击重置：恢复当前模板的默认值

### 4. 模板管理
点击"管理"按钮进入模板管理界面，可以：
- **新建模板**：输入新模板名称，基于默认模板创建
- **复制模板**：复制当前选中的模板
- **重命名**：修改模板名称
- **删除模板**：删除不需要的模板（默认模板不可删除）
- **设为默认**：将当前模板设为默认模板
- **保存设置**：修改模板参数后点击保存

### 5. 实时计算
- 输入任何参数后，所有结果自动更新
- 无需点击计算按钮，即时显示结果

## 数据存储

应用数据存储在手机内部存储中：
- 模板数据：`/data/data/com.unitpricecalculator/files/不能删除的数据文件.json`

**注意**：卸载应用会删除所有数据，请备份重要模板。

## 打包APK

### 前置要求
1. 安装Python 3.8+
2. 安装buildozer：`pip install buildozer`
3. 安装必要的依赖：
   - Ubuntu/WSL: `sudo apt-get install build-essential git python3 python3-dev openjdk-17-jdk autoconf libtool pkg-config zlib1g-dev libncurses5-dev libncursesw5-dev libtinfo5 cmake libffi-dev libssl-dev`
   - Windows: 需要WSL或Linux环境

### 打包步骤

1. 进入mobile目录：
```bash
cd mobile
```

2. 初始化buildozer（首次运行）：
```bash
buildozer init
```

3. 编辑buildozer.spec文件（已预配置）

4. 生成APK：
```bash
buildozer -v android debug
```

5. 等待编译完成（首次编译需要较长时间，约30-60分钟）

6. APK文件位置：
```
bin/unitpricecalculator-1.0.0-arm64-v8a-debug.apk
```

### 发布版本

如果要生成发布版本：
```bash
buildozer -v android release
```

注意：发布版本需要签名密钥。

## 常见问题

### Q: 应用无法安装？
A: 检查是否允许安装未知来源应用，在设置中开启。

### Q: 计算结果不准确？
A: 确保所有参数输入正确，检查模板设置。

### Q: 模板数据丢失？
A: 卸载应用会删除数据，请勿卸载。如需备份，可以导出JSON文件。

### Q: 应用闪退？
A: 检查Android版本是否满足要求（最低Android 5.0），尝试重启应用。

### Q: 如何备份模板？
A: 使用文件管理器访问应用数据目录，复制`不能删除的数据文件.json`文件。

### Q: 没有Linux环境怎么办？
A: 有以下解决方案：
1. **Kivy Launcher**：在手机上直接运行Python代码，无需打包
2. **在线打包**：使用 https://buildozer.io/ 等在线服务
3. **GitHub Actions**：设置自动化打包
4. **云服务器**：使用免费云服务器（如Oracle Cloud）

## 技术信息

- 开发框架：Kivy 2.x
- Python版本：3.8+
- 最低Android版本：5.0 (API 21)
- 目标Android版本：13 (API 33)
- 支持架构：arm64-v8a, armeabi-v7a

## 开发说明

### 项目结构
```
mobile/
├── main.py              # Kivy主程序
├── calculator.kv        # UI布局文件
├── calculator_logic.py  # 计算逻辑
├── template_manager.py  # 模板管理
├── buildozer.spec       # 打包配置
├── 模拟界面.html         # HTML模拟界面（用于预览）
└── assets/              # 资源文件
    ├── icon.png         # 应用图标
    └── presplash.png    # 启动屏幕
```

### 本地测试

在开发过程中，可以直接运行Python代码测试：

```bash
cd mobile
python main.py
```

这将在桌面环境中启动应用，方便调试。

### HTML模拟界面

使用 `模拟界面.html` 可以在浏览器中预览移动端效果，无需安装Kivy。

## 更新日志

### V3.0.0 (2026-01-31)
- 界面全面简化：去除花哨装饰，采用简洁实用风格
- 计算器界面：结果展示改为列表形式，更加清晰
- 模板管理界面：简化布局，紧凑显示
- 配色方案简化：黑白灰为主，蓝色突出核心结果
- 优化布局比例：计算器上半区40%，下半区60%
- 专注于功能，提升实用性

### V2.0.0 (2026-01-31)
- 重新设计界面布局：上下分区
- 上半区：信息展示（35%）
- 下半区：数据输入（65%）
- 优化移动端用户体验
- 添加实时反馈显示
- 改进视觉设计

### V1.0.0 (2026-01-31)
- 初始版本发布
- 实现所有桌面版功能
- 移动端界面优化
- 模板管理系统

## 联系支持

如有问题或建议，请联系开发者。

## 许可证

本应用为免费软件，仅供个人使用。
