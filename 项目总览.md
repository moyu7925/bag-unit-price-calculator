# 单价计算器V4 - 项目总览

## 项目结构

```
单价计算器/
├── 单价计算器.py              # 桌面版主程序（Tkinter）
├── template_manager.py        # 模板管理模块（共享）
├── 启动计算器.py              # 桌面版启动脚本
├── 打包.bat                   # 桌面版打包脚本
├── 使用说明.md                # 桌面版使用说明
│
├── mobile/                    # 移动端目录
│   ├── main.py                # Kivy主程序
│   ├── calculator.kv          # UI布局文件
│   ├── calculator_logic.py    # 计算逻辑
│   ├── template_manager.py    # 模板管理（复制自桌面版）
│   ├── buildozer.spec        # 打包配置
│   ├── README.md              # 移动版使用说明
│   ├── 打包指南.md            # APK打包详细指南
│   └── assets/                # 资源文件
│       └── README.md          # 图标说明
│
├── 启动移动版.bat             # 移动版测试启动脚本
├── 不能删除的数据文件.json    # 模板数据文件
└── dist/                      # 桌面版输出目录
    └── 单价计算器.exe          # 桌面版可执行文件
```

## 版本说明

### 桌面版（Tkinter）
- **文件**：`单价计算器.py`
- **框架**：Python Tkinter
- **平台**：Windows
- **启动**：双击 `单价计算器.exe` 或运行 `启动计算器.py`
- **特点**：
  - 完整的GUI界面
  - 模板管理系统
  - 实时计算
  - 详细计算过程显示

### 移动版（Kivy）
- **文件**：`mobile/main.py`
- **框架**：Python Kivy
- **平台**：Android
- **启动**：
  - 测试：运行 `启动移动版.bat`
  - 打包：参考 `mobile/打包指南.md`
- **特点**：
  - 移动端优化界面
  - 触摸友好操作
  - 与桌面版功能一致
  - 支持模板管理

## 快速开始

### 桌面版
1. 双击 `单价计算器.exe` 启动
2. 选择模板或使用默认值
3. 输入参数，自动计算
4. 查看结果和详细计算过程

### 移动版（测试）
1. 确保已安装Python和Kivy
2. 运行 `启动移动版.bat`
3. 在桌面环境中测试应用

### 移动版（打包APK）
1. 准备Linux环境（WSL/虚拟机/云服务器）
2. 参考 `mobile/打包指南.md`
3. 运行 `buildozer -v android debug`
4. 安装生成的APK到手机

## 功能对比

| 功能 | 桌面版 | 移动版 |
|------|--------|--------|
| 原料计算 | ✅ | ✅ |
| 加工计算 | ✅ | ✅ |
| 印刷计算 | ✅ | ✅ |
| 实时计算 | ✅ | ✅ |
| 模板管理 | ✅ | ✅ |
| 模板新建 | ✅ | ✅ |
| 模板复制 | ✅ | ✅ |
| 模板删除 | ✅ | ✅ |
| 模板重命名 | ✅ | ✅ |
| 设为默认 | ✅ | ✅ |
| 详细计算过程 | ✅ | ✅ |
| 数据持久化 | ✅ | ✅ |

## 开发说明

### 代码复用
- `template_manager.py` 在两个版本中共享
- 计算逻辑从桌面版提取到 `calculator_logic.py`
- UI层分别实现（Tkinter vs Kivy）

### 数据共享
两个版本使用相同的数据文件格式：
- 文件名：`不能删除的数据文件.json`
- 格式：JSON
- 内容：模板数据和最后使用的模板

### 扩展开发
如需添加新功能：
1. 修改 `calculator_logic.py` 添加计算逻辑
2. 在桌面版 `单价计算器.py` 中添加UI
3. 在移动版 `main.py` 和 `calculator.kv` 中添加UI
4. 确保两个版本功能一致

## 常见问题

### Q: 桌面版和移动版数据能同步吗？
A: 目前不能自动同步，但可以手动复制 `不能删除的数据文件.json` 文件。

### Q: 如何备份模板数据？
A: 复制 `不能删除的数据文件.json` 文件到安全位置。

### Q: 移动版打包需要多长时间？
A: 首次编译需要30-60分钟，后续编译会快很多。

### Q: 可以在iOS上运行吗？
A: 当前版本仅支持Android。如需iOS支持，需要使用Kivy iOS打包工具。

## 技术栈

### 桌面版
- Python 3.14
- Tkinter
- PyInstaller（打包）

### 移动版
- Python 3.8+
- Kivy 2.x
- Buildozer（打包）
- Android SDK/NDK

## 更新日志

### V4.0.0 (2026-01-31)
- 新增移动端Android版本
- 重构代码，提取计算逻辑
- 优化移动端界面
- 完善文档

## 许可证

本软件为免费软件，仅供个人使用。

## 联系支持

如有问题或建议，请联系开发者。
