#:kivy 1.11.0

<CalculatorScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: dp(5)
        spacing: dp(5)
        
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: None
            height: dp(40)
            background_color: [0.2, 0.2, 0.2, 1]
            
            Label:
                text: '单价计算器 V4'
                size_hint_x: 0.7
                font_size: dp(16)
                font_weight: 'bold'
                color: [1, 1, 1, 1]
                halign: 'center'
                text_size: self.size
                valign: 'middle'
        
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: None
            height: dp(40)
            padding: dp(5)
            
            Spinner:
                id: template_spinner
                size_hint_x: 0.8
                font_size: dp(13)
                on_text: app.on_template_selected(self, self.text)
            
            Button:
                text: '管理'
                size_hint_x: 0.2
                font_size: dp(13)
                background_color: [0.2, 0.2, 0.2, 1]
                color: [1, 1, 1, 1]
                on_release: app.open_template_manager()
        
        BoxLayout:
            orientation: 'vertical'
            size_hint_y: 0.4
            padding: dp(10)
            spacing: dp(2)
            
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: dp(35)
                
                Label:
                    text: '原料单价：'
                    size_hint_x: 0.5
                    font_size: dp(14)
                    color: [0.4, 0.4, 0.4, 1]
                    halign: 'left'
                    text_size: self.size
                    valign: 'middle'
                
                Label:
                    id: material_unit_price
                    text: '0.000 元'
                    size_hint_x: 0.5
                    font_size: dp(14)
                    font_weight: 'bold'
                    color: [0, 0, 0, 1]
                    halign: 'right'
                    text_size: self.size
                    valign: 'middle'
            
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: dp(35)
                
                Label:
                    text: '加工单价：'
                    size_hint_x: 0.5
                    font_size: dp(14)
                    color: [0.4, 0.4, 0.4, 1]
                    halign: 'left'
                    text_size: self.size
                    valign: 'middle'
                
                Label:
                    id: process_unit_price
                    text: '0.000 元'
                    size_hint_x: 0.5
                    font_size: dp(14)
                    font_weight: 'bold'
                    color: [0, 0, 0, 1]
                    halign: 'right'
                    text_size: self.size
                    valign: 'middle'
            
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: dp(35)
                
                Label:
                    text: '印刷单价：'
                    size_hint_x: 0.5
                    font_size: dp(14)
                    color: [0.4, 0.4, 0.4, 1]
                    halign: 'left'
                    text_size: self.size
                    valign: 'middle'
                
                Label:
                    id: print_unit_price
                    text: '0.000 元'
                    size_hint_x: 0.5
                    font_size: dp(14)
                    font_weight: 'bold'
                    color: [0, 0, 0, 1]
                    halign: 'right'
                    text_size: self.size
                    valign: 'middle'
            
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: dp(35)
                
                Label:
                    text: '单袋单价：'
                    size_hint_x: 0.5
                    font_size: dp(14)
                    color: [0.4, 0.4, 0.4, 1]
                    halign: 'left'
                    text_size: self.size
                    valign: 'middle'
                
                Label:
                    id: bag_unit_price
                    text: '0.000 元'
                    size_hint_x: 0.5
                    font_size: dp(16)
                    font_weight: 'bold'
                    color: [0, 0.4, 0.8, 1]
                    halign: 'right'
                    text_size: self.size
                    valign: 'middle'
            
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: dp(35)
                
                Label:
                    text: '原料重量：'
                    size_hint_x: 0.5
                    font_size: dp(14)
                    color: [0.4, 0.4, 0.4, 1]
                    halign: 'left'
                    text_size: self.size
                    valign: 'middle'
                
                Label:
                    id: material_weight
                    text: '0.000 kg'
                    size_hint_x: 0.5
                    font_size: dp(14)
                    font_weight: 'bold'
                    color: [0, 0, 0, 1]
                    halign: 'right'
                    text_size: self.size
                    valign: 'middle'
            
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: dp(35)
                
                Label:
                    text: '总费用：'
                    size_hint_x: 0.5
                    font_size: dp(14)
                    color: [0.4, 0.4, 0.4, 1]
                    halign: 'left'
                    text_size: self.size
                    valign: 'middle'
                
                Label:
                    id: total_fee
                    text: '0.000 元'
                    size_hint_x: 0.5
                    font_size: dp(14)
                    font_weight: 'bold'
                    color: [0, 0, 0, 1]
                    halign: 'right'
                    text_size: self.size
                    valign: 'middle'
        
        ScrollView:
            size_hint_y: 0.6
            
            BoxLayout:
                orientation: 'vertical'
                size_hint_y: None
                height: self.minimum_height
                spacing: dp(5)
                padding: dp(5)
                
                BoxLayout:
                    orientation: 'horizontal'
                    size_hint_y: None
                    height: dp(40)
                    padding: dp(5)
                    spacing: dp(5)
                    
                    CheckBox:
                        id: material_checkbox
                        size_hint_x: None
                        width: dp(18)
                        active: True
                        on_active: app.on_calculation_toggled(self, self.active)
                    
                    Label:
                        text: '原料'
                        size_hint_x: None
                        width: dp(40)
                        font_size: dp(13)
                        halign: 'left'
                        text_size: self.size
                        valign: 'middle'
                    
                    CheckBox:
                        id: process_checkbox
                        size_hint_x: None
                        width: dp(18)
                        active: True
                        on_active: app.on_calculation_toggled(self, self.active)
                    
                    Label:
                        text: '加工'
                        size_hint_x: None
                        width: dp(40)
                        font_size: dp(13)
                        halign: 'left'
                        text_size: self.size
                        valign: 'middle'
                    
                    CheckBox:
                        id: print_checkbox
                        size_hint_x: None
                        width: dp(18)
                        active: True
                        on_active: app.on_calculation_toggled(self, self.active)
                    
                    Label:
                        text: '印刷'
                        size_hint_x: None
                        width: dp(40)
                        font_size: dp(13)
                        halign: 'left'
                        text_size: self.size
                        valign: 'middle'
                    
                    Button:
                        text: '重置'
                        size_hint_x: None
                        width: dp(70)
                        font_size: dp(13)
                        background_color: [0.4, 0.4, 0.4, 1]
                        color: [1, 1, 1, 1]
                        on_release: app.reset_all_fields()
                
                BoxLayout:
                    orientation: 'vertical'
                    size_hint_y: None
                    height: self.minimum_height
                    padding: dp(8)
                    spacing: dp(3)
                    
                    Label:
                        text: '原料计算'
                        size_hint_y: None
                        height: dp(25)
                        font_size: dp(14)
                        font_weight: 'bold'
                        color: [0, 0, 0, 1]
                        halign: 'left'
                        text_size: self.size
                        valign: 'middle'
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        Label:
                            text: '开口(cm):'
                            size_hint_x: 0.35
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                        
                        TextInput:
                            id: opening
                            size_hint_x: 0.65
                            font_size: dp(13)
                            input_type: 'number'
                            input_filter: 'float'
                            multiline: False
                            on_text: app.on_value_changed(self, self.text)
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        Label:
                            text: '宽度(cm):'
                            size_hint_x: 0.35
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                        
                        TextInput:
                            id: width
                            size_hint_x: 0.65
                            font_size: dp(13)
                            input_type: 'number'
                            input_filter: 'float'
                            multiline: False
                            on_text: app.on_value_changed(self, self.text)
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        Label:
                            text: '厚度/C:'
                            size_hint_x: 0.35
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                        
                        TextInput:
                            id: thickness
                            size_hint_x: 0.65
                            font_size: dp(13)
                            input_type: 'number'
                            input_filter: 'float'
                            multiline: False
                            on_text: app.on_value_changed(self, self.text)
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        Label:
                            text: '参数值:'
                            size_hint_x: 0.35
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                        
                        TextInput:
                            id: param_value
                            size_hint_x: 0.65
                            font_size: dp(13)
                            input_type: 'number'
                            input_filter: 'float'
                            multiline: False
                            on_text: app.on_value_changed(self, self.text)
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        Label:
                            text: '原料价格:'
                            size_hint_x: 0.35
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                        
                        TextInput:
                            id: material_price
                            size_hint_x: 0.65
                            font_size: dp(13)
                            input_type: 'number'
                            input_filter: 'float'
                            multiline: False
                            on_text: app.on_value_changed(self, self.text)
                
                BoxLayout:
                    orientation: 'vertical'
                    size_hint_y: None
                    height: self.minimum_height
                    padding: dp(8)
                    spacing: dp(3)
                    
                    Label:
                        text: '加工计算'
                        size_hint_y: None
                        height: dp(25)
                        font_size: dp(14)
                        font_weight: 'bold'
                        color: [0, 0, 0, 1]
                        halign: 'left'
                        text_size: self.size
                        valign: 'middle'
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        Label:
                            text: '个数:'
                            size_hint_x: 0.35
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                        
                        TextInput:
                            id: quantity
                            size_hint_x: 0.65
                            font_size: dp(13)
                            input_type: 'number'
                            input_filter: 'float'
                            multiline: False
                            on_text: app.on_value_changed(self, self.text)
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        Label:
                            text: '工费参数:'
                            size_hint_x: 0.35
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                        
                        TextInput:
                            id: process_param
                            size_hint_x: 0.65
                            font_size: dp(13)
                            input_type: 'number'
                            input_filter: 'float'
                            multiline: False
                            on_text: app.on_value_changed(self, self.text)
                
                BoxLayout:
                    orientation: 'vertical'
                    size_hint_y: None
                    height: self.minimum_height
                    padding: dp(8)
                    spacing: dp(3)
                    
                    Label:
                        text: '印刷计算'
                        size_hint_y: None
                        height: dp(25)
                        font_size: dp(14)
                        font_weight: 'bold'
                        color: [0, 0, 0, 1]
                        halign: 'left'
                        text_size: self.size
                        valign: 'middle'
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        Label:
                            text: '工费参数:'
                            size_hint_x: 0.35
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                        
                        TextInput:
                            id: print_param
                            size_hint_x: 0.65
                            font_size: dp(13)
                            input_type: 'number'
                            input_filter: 'float'
                            multiline: False
                            on_text: app.on_value_changed(self, self.text)
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        Label:
                            text: '版材类型:'
                            size_hint_x: 0.35
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                        
                        Spinner:
                            id: material_type
                            size_hint_x: 0.65
                            font_size: dp(13)
                            values: ['铜板', '胶版']
                            text: '铜板'
                            on_text: app.on_material_type_changed(self, self.text)

<TemplateManagerScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: dp(5)
        spacing: dp(3)
        
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: None
            height: dp(40)
            
            Button:
                text: '返回'
                size_hint_x: 0.3
                font_size: dp(13)
                background_color: [0.2, 0.2, 0.2, 1]
                color: [1, 1, 1, 1]
                on_release: app.back_to_calculator()
            
            Label:
                text: '模板管理'
                size_hint_x: 0.7
                font_size: dp(16)
                font_weight: 'bold'
                halign: 'center'
                text_size: self.size
                valign: 'middle'
        
        BoxLayout:
            orientation: 'horizontal'
            
            ScrollView:
                size_hint_x: 0.4
                
                BoxLayout:
                    id: template_list_layout
                    orientation: 'vertical'
                    size_hint_y: None
                    height: self.minimum_height
                    spacing: dp(1)
                    canvas.before:
                        Color:
                            rgba: [0.98, 0.98, 0.98, 1]
                        Rectangle:
                            pos: self.pos
                            size: self.size
            
            BoxLayout:
                orientation: 'vertical'
                size_hint_x: None
                width: dp(1)
                canvas.before:
                    Color:
                        rgba: [0.9, 0.9, 0.9, 1]
                    Rectangle:
                        pos: self.pos
                        size: self.size
            
            ScrollView:
                size_hint_x: 0.6
                
                BoxLayout:
                    orientation: 'vertical'
                    size_hint_y: None
                    height: self.minimum_height
                    spacing: dp(6)
                    padding: dp(8)
                    
                    Label:
                        text: '参数设置'
                        size_hint_y: None
                        height: dp(25)
                        font_size: dp(14)
                        font_weight: 'bold'
                        color: [0, 0, 0, 1]
                        canvas.after:
                            Color:
                                rgba: [0.9, 0.9, 0.9, 1]
                            Rectangle:
                                pos: self.x, self.y
                                size: self.width, dp(2)
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        Label:
                            text: '模板名称:'
                            size_hint_x: 0.4
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                        
                        TextInput:
                            id: template_name
                            size_hint_x: 0.6
                            font_size: dp(13)
                            multiline: False
                            background_color: [1, 1, 1, 1]
                            canvas.before:
                                Color:
                                    rgba: [0.8, 0.8, 0.8, 1]
                                Line:
                                    rectangle: self.x, self.y, self.width, self.height
                                    width: 1
                    
                    Label:
                        text: '原料计算'
                        size_hint_y: None
                        height: dp(22)
                        font_size: dp(13)
                        font_weight: 'bold'
                        canvas.after:
                            Color:
                                rgba: [0.9, 0.9, 0.9, 1]
                            Rectangle:
                                pos: self.x, self.y
                                size: self.width, dp(2)
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        Label:
                            text: '参数值:'
                            size_hint_x: 0.4
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                        
                        TextInput:
                            id: param_value
                            size_hint_x: 0.6
                            font_size: dp(13)
                            input_type: 'number'
                            input_filter: 'float'
                            multiline: False
                            background_color: [1, 1, 1, 1]
                            canvas.before:
                                Color:
                                    rgba: [0.8, 0.8, 0.8, 1]
                                Line:
                                    rectangle: self.x, self.y, self.width, self.height
                                    width: 1
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        Label:
                            text: '原料价格:'
                            size_hint_x: 0.4
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                        
                        TextInput:
                            id: material_price
                            size_hint_x: 0.6
                            font_size: dp(13)
                            input_type: 'number'
                            input_filter: 'float'
                            multiline: False
                            background_color: [1, 1, 1, 1]
                            canvas.before:
                                Color:
                                    rgba: [0.8, 0.8, 0.8, 1]
                                Line:
                                    rectangle: self.x, self.y, self.width, self.height
                                    width: 1
                    
                    Label:
                        text: '加工计算'
                        size_hint_y: None
                        height: dp(22)
                        font_size: dp(13)
                        font_weight: 'bold'
                        canvas.after:
                            Color:
                                rgba: [0.9, 0.9, 0.9, 1]
                            Rectangle:
                                pos: self.x, self.y
                                size: self.width, dp(2)
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        Label:
                            text: '工费参数:'
                            size_hint_x: 0.4
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                        
                        TextInput:
                            id: process_param
                            size_hint_x: 0.6
                            font_size: dp(13)
                            input_type: 'number'
                            input_filter: 'float'
                            multiline: False
                            background_color: [1, 1, 1, 1]
                            canvas.before:
                                Color:
                                    rgba: [0.8, 0.8, 0.8, 1]
                                Line:
                                    rectangle: self.x, self.y, self.width, self.height
                                    width: 1
                    
                    Label:
                        text: '印刷计算'
                        size_hint_y: None
                        height: dp(22)
                        font_size: dp(13)
                        font_weight: 'bold'
                        canvas.after:
                            Color:
                                rgba: [0.9, 0.9, 0.9, 1]
                            Rectangle:
                                pos: self.x, self.y
                                size: self.width, dp(2)
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        Label:
                            text: '工费参数:'
                            size_hint_x: 0.4
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                        
                        TextInput:
                            id: print_param
                            size_hint_x: 0.6
                            font_size: dp(13)
                            input_type: 'number'
                            input_filter: 'float'
                            multiline: False
                            background_color: [1, 1, 1, 1]
                            canvas.before:
                                Color:
                                    rgba: [0.8, 0.8, 0.8, 1]
                                Line:
                                    rectangle: self.x, self.y, self.width, self.height
                                    width: 1
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        Label:
                            text: '版材类型:'
                            size_hint_x: 0.4
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                        
                        Spinner:
                            id: material_type
                            size_hint_x: 0.6
                            font_size: dp(13)
                            values: ['铜板', '胶版']
                            background_color: [1, 1, 1, 1]
                            canvas.before:
                                Color:
                                    rgba: [0.8, 0.8, 0.8, 1]
                                Line:
                                    rectangle: self.x, self.y, self.width, self.height
                                    width: 1
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        Label:
                            text: '铜板价格:'
                            size_hint_x: 0.4
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                        
                        TextInput:
                            id: material_type_price_copper
                            size_hint_x: 0.6
                            font_size: dp(13)
                            input_type: 'number'
                            input_filter: 'float'
                            multiline: False
                            background_color: [1, 1, 1, 1]
                            canvas.before:
                                Color:
                                    rgba: [0.8, 0.8, 0.8, 1]
                                Line:
                                    rectangle: self.x, self.y, self.width, self.height
                                    width: 1
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        Label:
                            text: '胶版价格:'
                            size_hint_x: 0.4
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                        
                        TextInput:
                            id: material_type_price_rubber
                            size_hint_x: 0.6
                            font_size: dp(13)
                            input_type: 'number'
                            input_filter: 'float'
                            multiline: False
                            background_color: [1, 1, 1, 1]
                            canvas.before:
                                Color:
                                    rgba: [0.8, 0.8, 0.8, 1]
                                Line:
                                    rectangle: self.x, self.y, self.width, self.height
                                    width: 1
                    
                    Label:
                        text: '计算模块启用'
                        size_hint_y: None
                        height: dp(22)
                        font_size: dp(13)
                        font_weight: 'bold'
                        canvas.after:
                            Color:
                                rgba: [0.9, 0.9, 0.9, 1]
                            Rectangle:
                                pos: self.x, self.y
                                size: self.width, dp(2)
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        CheckBox:
                            id: material_enabled
                            size_hint_x: None
                            width: dp(35)
                        
                        Label:
                            text: '原料计算'
                            size_hint_x: 0.8
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        CheckBox:
                            id: process_enabled
                            size_hint_x: None
                            width: dp(35)
                        
                        Label:
                            text: '加工计算'
                            size_hint_x: 0.8
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(35)
                        
                        CheckBox:
                            id: print_enabled
                            size_hint_x: None
                            width: dp(35)
                        
                        Label:
                            text: '印刷计算'
                            size_hint_x: 0.8
                            font_size: dp(13)
                            halign: 'left'
                            text_size: self.size
                            valign: 'middle'
                    
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(40)
                        
                        Button:
                            text: '保存'
                            size_hint_x: 0.5
                            font_size: dp(13)
                            background_color: [0.2, 0.2, 0.2, 1]
                            color: [1, 1, 1, 1]
                            on_release: app.save_template_settings()
                        
                        Button:
                            text: '设为默认'
                            size_hint_x: 0.5
                            font_size: dp(13)
                            background_color: [0.2, 0.2, 0.2, 1]
                            color: [1, 1, 1, 1]
                            on_release: app.set_as_default()
        
        BoxLayout:
            orientation: 'vertical'
            size_hint_y: None
            height: dp(120)
            canvas.before:
                Color:
                    rgba: [0.97, 0.97, 0.97, 1]
                Rectangle:
                    pos: self.pos
                    size: self.size
            
            Label:
                text: '模板操作'
                size_hint_y: None
                height: dp(25)
                font_size: dp(14)
                font_weight: 'bold'
                color: [0, 0, 0, 1]
                canvas.after:
                    Color:
                        rgba: [0.9, 0.9, 0.9, 1]
                    Rectangle:
                        pos: self.x, self.y
                        size: self.width, dp(2)
            
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: dp(35)
                
                Label:
                    text: '新模板名称:'
                    size_hint_x: 0.3
                    font_size: dp(13)
                    halign: 'left'
                    text_size: self.size
                    valign: 'middle'
                
                TextInput:
                    id: new_template_name
                    size_hint_x: 0.7
                    font_size: dp(13)
                    multiline: False
                    background_color: [1, 1, 1, 1]
                    canvas.before:
                        Color:
                            rgba: [0.8, 0.8, 0.8, 1]
                        Line:
                            rectangle: self.x, self.y, self.width, self.height
                            width: 1
            
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: dp(40)
                
                Button:
                    text: '新建'
                    size_hint_x: 0.25
                    font_size: dp(13)
                    background_color: [0.2, 0.2, 0.2, 1]
                    color: [1, 1, 1, 1]
                    on_release: app.create_new_template()
                
                Button:
                    text: '复制'
                    size_hint_x: 0.25
                    font_size: dp(13)
                    background_color: [0.2, 0.2, 0.2, 1]
                    color: [1, 1, 1, 1]
                    on_release: app.duplicate_template()
                
                Button:
                    text: '重命名'
                    size_hint_x: 0.25
                    font_size: dp(13)
                    background_color: [0.2, 0.2, 0.2, 1]
                    color: [1, 1, 1, 1]
                    on_release: app.rename_template()
                
                Button:
                    text: '删除'
                    size_hint_x: 0.25
                    font_size: dp(13)
                    background_color: [0.6, 0.2, 0.2, 1]
                    color: [1, 1, 1, 1]
                    on_release: app.delete_template()
