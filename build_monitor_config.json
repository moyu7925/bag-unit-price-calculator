{
  "repo_owner": "moyu7925",
  "repo_name": "bag-unit-price-calculator",
  "branch": "main",
  "workflow_file": ".github/workflows/android.yml",
  "max_iterations": 30,
  "check_interval": 30,
  "github_token_env": "GITHUB_TOKEN",
  "monitoring": {
    "enabled": true,
    "auto_fix": true,
    "auto_push": true,
    "max_fix_attempts": 5
  },
  "error_patterns": {
    "fix_aidl": {
      "patterns": ["aidl not found", "aidl.*does not exist", "cannot find aidl"],
      "priority": "high",
      "fix_method": "add_platform_tools_download",
      "description": "AIDL工具缺失，需要下载platform-tools"
    },
    "fix_sdkmanager": {
      "patterns": ["sdkmanager.*not found", "sdkmanager.*does not exist"],
      "priority": "high",
      "fix_method": "reinstall_cmdline_tools",
      "description": "SDK Manager缺失，需要重新安装cmdline-tools"
    },
    "fix_license": {
      "patterns": ["license.*not accepted", "license.*rejected"],
      "priority": "high",
      "fix_method": "add_license_acceptance",
      "description": "许可证未接受，需要添加许可证接受步骤"
    },
    "fix_build_tools": {
      "patterns": ["build-tools.*not found", "cannot find build-tools"],
      "priority": "medium",
      "fix_method": "install_build_tools",
      "description": "Build Tools缺失，需要安装指定版本"
    },
    "fix_platform_tools": {
      "patterns": ["platform-tools.*not found", "cannot find platform-tools"],
      "priority": "high",
      "fix_method": "install_platform_tools",
      "description": "Platform Tools缺失，需要安装platform-tools"
    },
    "fix_ndk": {
      "patterns": ["ndk.*not found", "cannot find ndk"],
      "priority": "medium",
      "fix_method": "install_ndk",
      "description": "NDK缺失，需要安装指定版本的NDK"
    },
    "fix_timeout": {
      "patterns": ["timeout", "timed out"],
      "priority": "medium",
      "fix_method": "increase_timeout",
      "description": "构建超时，需要增加超时时间"
    },
    "fix_memory": {
      "patterns": ["memory.*exceeded", "out of memory"],
      "priority": "low",
      "fix_method": "optimize_memory",
      "description": "内存不足，需要优化内存使用"
    },
    "fix_disk": {
      "patterns": ["disk.*space", "no space left"],
      "priority": "low",
      "fix_method": "clean_disk",
      "description": "磁盘空间不足，需要清理磁盘"
    },
    "fix_buildozer": {
      "patterns": ["buildozer.*error"],
      "priority": "high",
      "fix_method": "fix_buildozer_config",
      "description": "Buildozer错误，需要修复配置"
    }
  },
  "fix_methods": {
    "add_platform_tools_download": {
      "workflow_section": "Install Android SDK components",
      "code": "\n         if [ ! -f \"$ANDROID_HOME/platform-tools/aidl\" ]; then\n           echo \"aidl not found, downloading platform-tools...\"\n           cd /tmp\n           rm -rf platform-tools platform-tools.zip\n           wget -q --tries=3 --timeout=30 https://dl.google.com/android/repository/platform-tools-latest-linux.zip -O platform-tools.zip\n           unzip -q -o platform-tools.zip\n           mkdir -p $ANDROID_HOME/platform-tools\n           cp -rf platform-tools/* $ANDROID_HOME/platform-tools/\n           chmod +x $ANDROID_HOME/platform-tools/aidl\n         fi\n         \n         if [ -f \"$ANDROID_HOME/platform-tools/aidl\" ]; then\n           echo \"✓ aidl found\"\n           $ANDROID_HOME/platform-tools/aidl --version || true\n         fi\n"
    },
    "reinstall_cmdline_tools": {
      "workflow_section": "Setup Android SDK",
      "code": "\n         mkdir -p $ANDROID_HOME/cmdline-tools\n         cd /tmp\n         if [ ! -f \"cmdline-tools.zip\" ]; then\n           wget -q --tries=3 --timeout=30 https://dl.google.com/android/repository/commandlinetools-linux-11076708_latest.zip -O cmdline-tools.zip\n         fi\n         unzip -q -o cmdline-tools.zip\n         rm -rf $ANDROID_HOME/cmdline-tools/latest\n         mv cmdline-tools $ANDROID_HOME/cmdline-tools/latest\n         chmod +x $ANDROID_HOME/cmdline-tools/latest/bin/*\n"
    },
    "add_license_acceptance": {
      "workflow_section": "Accept Android SDK licenses",
      "code": "\n        echo \"d56f5187479451eabf01fb78af6dfcb131a6481e\" > ~/.android/google-android-ndk-license\n"
    },
    "install_build_tools": {
      "workflow_section": "Install Android SDK components",
      "code": "\n        sdkmanager --install \"build-tools;34.0.0\" || true\n"
    },
    "install_platform_tools": {
      "workflow_section": "Install Android SDK components",
      "code": "\n        sdkmanager --install \"platform-tools\" || true\n"
    },
    "install_ndk": {
      "workflow_section": "Install Android SDK components",
      "code": "\n        sdkmanager --install \"ndk;25b\" || true\n"
    },
    "increase_timeout": {
      "workflow_section": "build job",
      "code": "\n        timeout-minutes: 90\n"
    },
    "optimize_memory": {
      "workflow_section": "Build APK with retry",
      "code": "\n        buildozer android clean\n        sleep 5\n"
    },
    "clean_disk": {
      "workflow_section": "Install system dependencies",
      "code": "\n        sudo apt-get clean\n        sudo rm -rf /tmp/*\n"
    },
    "fix_buildozer_config": {
      "workflow_section": "Configure Buildozer",
      "code": "\n        sed -i 's/^android.api = .*/android.api = ${{ env.ANDROID_API }}/' buildozer.spec || true\n        sed -i 's/^android.ndk = .*/android.ndk = ${{ env.ANDROID_NDK }}/' buildozer.spec || true\n"
    }
  },
  "notifications": {
    "enabled": false,
    "webhook_url": "",
    "on_success": true,
    "on_failure": true,
    "on_fix_applied": true
  },
  "logging": {
    "enabled": true,
    "log_file": "build_monitor.log",
    "log_level": "INFO",
    "max_log_size": "10MB",
    "backup_count": 5
  },
  "cache": {
    "enabled": true,
    "cache_dir": ".buildozer_cache",
    "max_cache_age": 86400
  },
  "retry_policy": {
    "max_retries": 3,
    "retry_delay": 10,
    "retry_on_timeout": true,
    "retry_on_network_error": true
  },
  "build_timeout": {
    "default": 3600,
    "max_retries_timeout": 5400
  }
}
